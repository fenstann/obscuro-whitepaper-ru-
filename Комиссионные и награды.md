# Комиссионные и награды

Obscuro предусматривает простую структуру комиссионных и наград. Конечные пользователи оплачивают комиссионные, основанные на их использовании, которые помещаются в пул, из которого выплачиваются награды для нод.

Данная структура обеспечивает стабильный и предсказуемый доход для операторов нод в долгосрочной перспективе и предсказуемую плату для пользователей, пропорциональную фактическим затратам на функционирование сети, не зависящую от конкуренции при покупке на торгах и не меняющуюся в зависимости от активности.

Также, эта структура не наказывает агрегаторов, упускающих возможность публикации, которая сокращает вознаграждения. Вместо этого, потеря вознаграждения должна быть достатойным стимулом.

Поскольку Obscuro не связывает комиссионные и награды напрямую, высокоуровневая цель этого механизма - найти стабильное равновесие между суммами, вносимыми в пул конечными пользователями, и суммами, выплачиваемыми нодам за их услуги. В периоды высокой загрузки сети, пул будет расти, и эти дополнительные средства будут использоваться в устойчивые периоды времени для более частой публикации роллапов, тем самым, обеспечивая лучший пользовательский опыт. 

## Стоимостное обслуживание нод на L2 

Операторы управляют сетью и несут операционные расходы на эксплуатацию и обслуживание нод.

Переменная "ожидаемые ежемесячные эксплуатационные расходы узла" устанавливается через протокол управления, который предназначен для отражения того, сколько оператор ноды будет платить за аппаратное обеспечение, хостинг и т.д. в течение месяца. Это аналогично сложности proof-of-work, встречающейся в других блокчейнах. Это влияет на спрос на эксплуатацию ноды.

Ноды-агрегаторы несут расходы, связанные с отправкой транзакций на L1, за счет следующего:

- Хранение данных роллапа на Ethereum.
- Дополнительные расходы на обработку транзакции L1, использующие роллап.

## Комиссии при транзакции

Общая комиссия, которую должен заплатить пользователь, состоит из трех компонентов.

1. Доля ежемесячных операционных расходов для всех нод. Она рассчитывается на основе вычисления текущей транзакции пропорционально средней скользящей всех транзакций L2 за месяц. Выглядит как:

![proportion_equation.png](./images/proportion_equation.png)

![operation_equation.png](./images/operation_equation.png)

2. Стоимость, затрачиваемая нодами за хранение на L1, представляется как:

![storage_equation.png](./images/storage_equation.png)

3. Доля дополнительных  расходов, понесенная нодами за обработку роллапа, выглядит следующим образом:

- В момент транзакции невозможно узнать, какова истинная стоимость будущего роллапа.
- Пользователи должны оплатить свою справедливую долю стоимости будущего роллапа.
- Лучшим показателем того, какой может быть стоимость будущего роллапа, является средней скользящим значением предыдущих n-роллапов.
- Если количество n велико, усреднение производится по большему числу роллапов и следовательно, при менее волатильном варианте наоборот.
- Вычисления, необходимые нодам Obscuro для выполнения транзакции, оцениваются с помощью механизма учета, аналогичного тому, что существует в Ethereum.
- Используя эту информацию, Obscuro рассчитывает долю каждой транзакции от общего объема вычислений в среднем блоке.
- Основой для расчета комиссионных на L1 является стоимость публикации среднего роллапа на L1.
- Каждая транзакция оплачивает долю этих затрат пропорционально своим вычислениям.


![overhead_equation.png](./images/overhead_equation.png)

Это дает возможность предсказать сумму комиссионных за каждую транзакцию:

![total_fee_equation.png](./images/total_fee_equation.png)

## Вознаграждения для нод на L2

Протокол Obscuro вознаграждает как валидаторов, так и агрегаторов, которые следят за сетью, с помощью лотереи. Лотерея случайным образом награждает активные узлы в каждом раунде вознаграждением OBX за участие. Узлы доказывают, что они активны, требуя свое вознаграждение в течение нескольких последующих блоков; в противном случае вознаграждение сжигается. Вознаграждение в каждом раунде рассчитывается таким образом, чтобы покрыть операционные расходы этих нод.

Ноды-агрегаторы имеют дополнительный механизм вознаграждения, который выплачивает вознаграждение в OBX при успешной публикации роллапа на основе правил протокола POBI. Это вознаграждение покрывает как минимум понесенные затраты за газ на L1 и не превышает двойную стоимость газа на L1.

Сумма лотерейных выплат за раунд роллапа представлена в виде:

![active_node_reward_equation.png](./images/active_node_reward_equation.png)

## Бутстрэппинг сети

Когда сеть только запускается, разумно ожидать низкого объема транзакций, что может создать ситуацию, в которой:

1. Агрегаторы могут постоянно публиковать данные с высокой периодичностью и поглощать то, что может оказаться убыточной операцией.
2. Агрегаторы могут снизить скорость публикации роллапов, что приведет к ухудшению пользовательского опыта.
3. В качестве альтернативы, сеть может стимулировать ранние транзакции, позволяя обеим группам преуспеть.

Хотя Obscuro оптимизируется для конечных пользователей, ранние ноды также должны быть прибыльными. Поэтому Obscuro идет по пути варианта 3.

В первые дни работы сети, комиссии будут стимулироваться за счет недавно выпущенных токенов, чтобы ранние пользователи не сталкивались с чрезмерными комиссиями. Цена транзакции фиксирована на уровне $1 в OBX, пока сеть Obscuro не стабилизируется. Для нод, предусмотрен период субсидирования, который со временем сокращается, пока объем транзакций не наберет обороты.
